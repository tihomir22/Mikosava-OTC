<div
  class="coin-viewport"
  [ngClass]="{ 'd-none': trades.length == 0 }"
  [ngStyle]="{ width: 100 + '%', height: 300 + 'px' }"
>
  <ngx-skeleton-loader count="10" *ngIf="!tradesLoaded"></ngx-skeleton-loader>
  <div
    class="list-group-item list-group-item-action row d-flex tradeItem"
    (dblclick)="clickTradeItem.emit(trade)"
    *ngFor="let trade of trades | sort : 'sortTradeId' : 'DESC'"
  >
    <div class="col flex-grow-0">#{{ trade.tradeId }}</div>
    <div class="col flex-grow-2">
      <app-status-displayer [trade]="trade"></app-status-displayer>
    </div>

    <div class="col pairA flex-grow-4 justify-content-center">
      <ng-container *ngIf="trade.type == 'erc20'; else nftTemplateA">
        <span>
          {{
            trade.amountA
              | parseFromWeiToDecimalNumber : trade.aTokenAddress
              | async
              | number
          }}
        </span>
        <app-coin-img-badge
          [readOnly]="true"
          [src]="(trade.aTokenAddress | fromAddressToCg | async)?.image ?? ''"
          [coinLabel]="
            (trade.aTokenAddress | fromAddressToCg | async)?.name ?? ''
          "
          [defaultLabel]="'Loading...'"
        ></app-coin-img-badge>
      </ng-container>
      <ng-template #nftTemplateA>
        <div class="nft-info mx-2">
          <button
            type="button"
            name=""
            id=""
            class="btn btn-outline-primary details-btn"
            (click)="viewNftDetails.emit([trade.aTokenAddress, trade.amountA])"
          >
            <i-bs
              [name]="iconNames.Search"
              [width]="'16px'"
              [height]="'16px'"
            ></i-bs
            >View details
          </button>
        </div>
        <img
          class="identicon-nft"
          [src]="
            'data:image/png;base64,' +
            transformToIdenticoin(trade.amountA + trade.aTokenAddress, options)
          "
        />
      </ng-template>
    </div>
    <div class="col flex-grow-0 d-none d-lg-flex">
      <i-bs [name]="iconNames.ArrowLeftRight"></i-bs>
    </div>
    <div class="col pairB flex-grow-4 justify-content-center">
      <ng-container *ngIf="trade.type == 'erc20'; else nftTemplateB">
        <span>
          {{
            trade.amountB
              | parseFromWeiToDecimalNumber : trade.bTokenAddress
              | async
              | number
          }}
        </span>
        <app-coin-img-badge
          [readOnly]="true"
          [src]="(trade.aTokenAddress | fromAddressToCg | async)?.image ?? ''"
          [coinLabel]="
            (trade.aTokenAddress | fromAddressToCg | async)?.name ?? ''
          "
          [defaultLabel]="'Loading...'"
        ></app-coin-img-badge>
      </ng-container>
      <ng-template #nftTemplateB>
        <img
          class="identicon-nft"
          [src]="
            'data:image/png;base64,' +
            transformToIdenticoin(trade.amountB + trade.bTokenAddress, options)
          "
        />
        <div class="nft-info mx-2">
          <button
            type="button"
            name=""
            id=""
            class="btn btn-outline-primary details-btn"
            (click)="viewNftDetails.emit([trade.bTokenAddress, trade.amountB])"
          >
            <i-bs
              [name]="iconNames.Search"
              [width]="'16px'"
              [height]="'16px'"
            ></i-bs
            >View details
          </button>
        </div>
      </ng-template>
    </div>
    <div class="col flex-grow-1 justify-content-center">
      <ng-container *ngIf="trade.validUntil == 0; else validUntilSet">
        <i-bs width="2rem" height="2rem" [name]="iconNames.Infinity"></i-bs>
      </ng-container>
      <ng-template #validUntilSet>
        <app-valid-until-progressbar
          class="w-100"
          [trade]="trade"
        ></app-valid-until-progressbar>
      </ng-template>
    </div>
    <div class="col actions flex-grow-1 d-flex justify-content-end">
      <div class="btn-group" dropdown placement="left" container="body">
        <button
          id="button-animated"
          dropdownToggle
          type="button"
          class="hidden-button"
          aria-controls="dropdown-animated"
        >
          <i-bs [name]="iconNames.ThreeDotsVertical" class="mx-2"></i-bs>
        </button>
        <ul
          id="dropdown-animated"
          *dropdownMenu
          class="dropdown-menu trade-actions-dropdown"
          role="menu"
          aria-labelledby="button-animated"
        >
          <li role="menuitem">
            <a
              class="dropdown-item text-secondary"
              (click)="clickTradeItem.emit(trade)"
              ><i-bs [name]="iconNames.Eye" class="mx-2"></i-bs>Open trade</a
            >
          </li>
          <li role="menuitem">
            <a
              class="dropdown-item text-primary"
              (click)="shareTradeItem.emit(trade)"
              ><i-bs [name]="iconNames.QrCode" class="mx-2"></i-bs>Share</a
            >
          </li>
          <li
            role="menuitem"
            [ngClass]="{ disabled: trade.cancelled || trade.sold }"
          >
            <a
              class="dropdown-item cancel-btn {{
                trade.cancelled || trade.sold ? 'disabled' : 'text-danger'
              }}"
              (click)="cancelTradeItem.emit(trade)"
              ><i-bs [name]="iconNames.XCircle" class="mx-2"></i-bs>Cancel</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="empty-list w-100" *ngIf="trades.length == 0">
  <app-not-found
    [subtext]="'TRADE.NOT_FOUND_TRADES_SUBTITLE' | translate"
    [text]="'TRADE.NOT_FOUND_TRADES' | translate"
  ></app-not-found>
</div>
